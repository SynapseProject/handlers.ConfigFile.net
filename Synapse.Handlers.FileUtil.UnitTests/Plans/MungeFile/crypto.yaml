Name: SamplePlan
Actions:
- Name: Action001
  Handler:
    Type: synapse.handlers.Fileutil:MungeFileHandler
    Config: 
      Type: Yaml
      Values:
        Type: INI
        BackupSource: true
        CreateSettingIfNotFound: true
        RunSequential: true
  Parameters:
    Crypto:
      Provider:
        Config:
          Values:
            Uri: $WORKING_DIRECTORY\pubPriv.key
    Values:
      Files:
      - Source: $WORKING_DIRECTORY\regex.config
        Destination: $WORKING_DIRECTORY\crypto-regex.config.new
        SettingsFile: 
          Name: $WORKING_DIRECTORY\regextransform-crypto.csv
          HasEncryptedValues: true
        Type: Regex
        Settings:
        - Key: (SET\s*ENDUR_VER\s*=\s*).*?$
          Value: ${1}NEW_VERSION_NUMBER_HERE
      - Source: $WORKING_DIRECTORY\xpath.config
        Destination: $WORKING_DIRECTORY\crypto-xpath.config.new
        SettingsFile:
          Name: $WORKING_DIRECTORY\xpathtransform-crypto.csv
          HasEncryptedValues: true
        Type: XPath
        Settings:
        - Key: "//configuration/applicationSettings/MyService.Properties.Settings/setting[@name=\"initVector\"]/value"
          Value: "MyNewValue"
      - Source: $WORKING_DIRECTORY\web.config
        Destination: $WORKING_DIRECTORY\crypto-web.config.new
        SettingsFile:
          Name: $WORKING_DIRECTORY\xmltransform-crypto.xml
          HasEncryptedValues: true
        Type: XmlTransform